policies:
     # terraform allows two different forms of defining permissions on a security
     # group, inline and with a separate resource, we could either define a single
     # policy to look for both, or two separate policies.

   - name: check-security-group-open-cidr
     resource: terraform.aws_instance
     description: "EC2 should not be open to world on ssh"
     filters:
       - type: traverse
         resources:
           - aws_security_group
           - aws_security_ingress_permission
         attrs:
           - Ipv4: 0.0.0.0/0
      
   - name: check-security-group-inline-open-cidr
     resource: terraform.aws_instance
     description: "EC2 instance using wide open security group"
     filters:
       - type: traverse
         resources: [aws_security_group]
         attrs:
           - key: ingress.cidr_blocks
             value: 0.0.0.0/0
             op: contains


